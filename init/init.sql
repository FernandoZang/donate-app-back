USE SANEM;

CREATE TABLE CIDADE (
    ID INT NOT NULL PRIMARY KEY,
    NOME VARCHAR(100) NOT NULL
);

CREATE TABLE USUARIO (
    id INT NOT NULL PRIMARY KEY,
    nome VARCHAR(150) NOT NULL,
    CPF VARCHAR(20) NOT NULL,
    email VARCHAR(50),
    fone VARCHAR(50),
    tipo VARCHAR(50) NOT NULL,
    UF VARCHAR(2) NOT NULL,
    bairro VARCHAR(255) NOT NULL,
    logradouro VARCHAR(255) NOT NULL,
    logradouro_tipo VARCHAR(255) NOT NULL,
    numero VARCHAR(255) NOT NULL,
    complemento VARCHAR(255),
    status VARCHAR(50) NOT NULL,
    active VARCHAR(50) NOT NULL,
    cod_cidade INT NOT NULL,
    FOREIGN KEY (cod_cidade) REFERENCES CIDADE(id)
);

CREATE TABLE BENEFICIARIO (
    id INT NOT NULL PRIMARY KEY,
    nome VARCHAR(150) NOT NULL,
    CPF VARCHAR(20),
    email VARCHAR(50),
    fone VARCHAR(50),
    tipo VARCHAR(50) NOT NULL,
    UF VARCHAR(2) NOT NULL,
    bairro VARCHAR(255),
    logradouro VARCHAR(255),
    logradouro_tipo VARCHAR(255),
    numero VARCHAR(255),
    complemento VARCHAR(255),
    status VARCHAR(50) NOT NULL,
    active VARCHAR(50) NOT NULL,
    observacao VARCHAR(500),
    cod_cidade INT NOT NULL,
    FOREIGN KEY (cod_cidade) REFERENCES CIDADE(id)
);

CREATE TABLE REGRA_ACESSO (
    id INT NOT NULL PRIMARY KEY,
    nome VARCHAR(150) NOT NULL
);

CREATE TABLE USUARIO_REGRA_ACESSO (
    COD_USUARIO INT NOT NULL,
    COD_REGRA_ACESSO INT NOT NULL,
    PRIMARY KEY (COD_USUARIO, COD_REGRA_ACESSO),
    FOREIGN KEY (COD_USUARIO) REFERENCES USUARIO(id),
    FOREIGN KEY (COD_REGRA_ACESSO) REFERENCES REGRA_ACESSO(id)
);

CREATE TABLE PRODUTO (
    id INT NOT NULL PRIMARY KEY,
    descricao VARCHAR(100) NOT NULL,
    quantidade INT NOT NULL,
    tipo VARCHAR(100) NOT NULL,
    tamanho VARCHAR(100) NOT NULL
);

CREATE TABLE DISTRIBUICAO (
    COD_USUARIO INT NOT NULL,
    COD_PRODUTO INT NOT NULL,
    descricao VARCHAR(100) NOT NULL,
    quantidade INT NOT NULL,
    data DATETIME NOT NULL,
    PRIMARY KEY (COD_USUARIO, COD_PRODUTO),
    FOREIGN KEY (COD_USUARIO) REFERENCES USUARIO(id),
    FOREIGN KEY (COD_PRODUTO) REFERENCES PRODUTO(id)
);

CREATE TABLE HISTORICO (
    COD_PRODUTO INT NOT NULL,
    COD_USUARIO INT NOT NULL,
    quantidade INT NOT NULL,
    tipo_movimento VARCHAR(2) NOT NULL,
    PRIMARY KEY (COD_PRODUTO, COD_USUARIO),
    FOREIGN KEY (COD_PRODUTO) REFERENCES PRODUTO(id),
    FOREIGN KEY (COD_USUARIO) REFERENCES USUARIO(id)
);